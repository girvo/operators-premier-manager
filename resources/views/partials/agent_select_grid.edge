<div class="space-y-6" data-agent-grid>
  @each(group in agentGroups)
    <div>
      <div class="flex items-center justify-between mb-2">
        <h3 class="text-sm font-semibold text-valorant-light">
          {{ group.role }}
        </h3>
        <button
          type="button"
          class="text-xs text-valorant-red hover:text-valorant-red/80 transition"
          data-agent-select-all="{{ group.role }}"
        >
          Select all
        </button>
      </div>
      <div class="grid grid-cols-4 sm:grid-cols-6 gap-2">
        @each(agent in group.agents)
          @let(isChecked = selectedAgents.includes(agent.key))
          <label class="cursor-pointer">
            <input
              type="checkbox"
              name="{{ formFieldName }}"
              value="{{ agent.key }}"
              class="peer sr-only"
              data-agent-role="{{ group.role }}"
              {{ isChecked ? 'checked' : '' }}
            />
            <div
              class="rounded border border-valorant-light/20 bg-valorant-dark/60 p-2 text-center transition
                peer-checked:border-valorant-red peer-checked:bg-valorant-red/10"
            >
              <img
                src="/images/agent-icons/{{ agent.key }}.png"
                alt="{{ agent.name }}"
                class="w-10 h-10 mx-auto"
              />
              <div class="mt-1 text-[11px] text-valorant-light/80">
                {{ agent.name }}
              </div>
            </div>
          </label>
        @end
      </div>
    </div>
  @end
</div>

<script>
  (function () {
    const grids = document.querySelectorAll("[data-agent-grid]");
    grids.forEach((grid) => {
      grid.addEventListener("click", (event) => {
        const target = event.target;
        if (!(target instanceof HTMLElement)) {
          return;
        }
        const role = target.getAttribute("data-agent-select-all");
        if (!role) {
          return;
        }
        const checkboxes = grid.querySelectorAll(
          `input[type="checkbox"][data-agent-role="${role}"]`
        );
        checkboxes.forEach((checkbox) => {
          checkbox.checked = true;
        });
      });
    });
  })();
</script>
